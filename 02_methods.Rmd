# Quantitative Tool for Evaluating Rebuilding

## Feed-back simulations

Fisheries management is frequently tasked with implementing strategies that meet multiple, and often conflicting, broad objectives while remaining robust to sources of uncertainty. Management strategy evaluation (MSE) is a decision-making framework that allows scientists, managers, First Nations, and stakeholders to collaboratively develop and test alternative management procedures in a controlled environment. In the MSE framework a management procedure is the combination of (i) a data collection scheme, (ii) a method of assessing CU status, and (iii) management actions based on estimated CU status (i.e. harvest control rules). The MSE process begins with the identification of fully-specified objectives (i.e. time to and probability of reaching specific recovery targets) and the development of management procedure that could realistically be implemented to meet those objectives. 

Once objectives and performance indicators have been identified, closed-loop computer simulations are used to apply and evaluate different management procedures. In these simulations, real-world CUs and fisheries are replaced by a series of models that represent several distinct processes: the dynamics of fish populations, observations of these populations, and the behaviour of the fishery. Together these models constitute an operating model that represents a hypothesis about how the “true” system behaves. The operating model is initially parameterized with historical data or representative values drawn from previous studies. 

A principal goal of MSE is to determine how robust distinct management procedures are to sources of uncertainty (e.g. form of stock-recruit relationships, precision of spawner abundance estimates, and implementation of harvest control rules). Multiple dimensions of uncertainty are incorporated into an MSE by designing several operating models, with each model containing unique combinations of parameter values and underlying model structures that represents a specific hypothesis about the system’s behaviour. Different management procedures are then applied to each operating model creating a suite of unique scenarios (each scenario equals one operating model and one management procedure). Every scenario is then iterated across many time steps to incorporate stochasticity and explore how the system is likely to behave in the future (Figure 1). Finally, management procedures are evaluated relative to one another based on their mean performance across many trials. By comparing how management procedures perform across multiple operating models, MSE allows managers and stakeholders to assess trade-offs between exploitation/yield and conservation objectives under varying degrees of uncertainty. 

Although technically complex, closed-loop simulation models can be broken down into relatively simple components, including stock dynamics, collection of spawner and harvest data, assessment of status, application of harvest decision rule, and implementation of a fishery (\@ref(fig:fig1)). The quantitative model described here can become the foundation for a future MSE processes that would be developed in collaboration with First Nations and stakeholders. The structure of the model is described in more detail in below. 


```{r fig1, fig.cap="Schematic of closed-loop simulation within Management Strategy Evaluation.", out.width=250}
knitr::include_graphics("knitr-figs-pdf/MSEschematic.png")
```

Yet these models are of little use without quantitative and realistic rebuilding goals that are actually relevant to management, and that can be used to assess the performance of management procedures. Ideally, these goals should include three components: a threshold representing CU status (e.g. a level of spawner abundance), a target probability of reaching or avoiding the threshold, and a minimum/maximum number of years to reach the threshold.  

Four goals of the simulation evaluation were identified through engagement with Fisheries Management at an initial Workshop in December 2017. These goals represented four different modules of the project. Efforts have focused on the first 3 to date, with consideration of the fourth only implemented in a cursory way and additional recommendations included in the final section below. Parenthesis highlight in which case studies and primary publications these goals were addressed.

1. Evaluate impact of candidate harvest strategies on rebuilding (Case Study 1, @freshwater2019; @freshwater2020)

2. Evaluate the impact of uncertainty in productivity and associated trends on rebuilding (Case Study 1, @freshwater2019; @freshwater2020). 

3. Evaluate impacts of combinations of mixed and single-stock fisheries on rebuilding (Case Study 1, @freshwater2019).

4. Evaluate the impacts of uncertainties in assessment (changes in frequency and intensity of assessment) and from implementing management strategies (outcome uncertainties) on rebuilding and our ability to detect recovery. (Case Study 2)


The Appendix includes a complete list of modules considered (Section \@ref(app:appendix)).

## samSim- A Generic Simulation tool

`samSim` is an R package containing functions to quantify the rebuilding potential for Pacific salmon populations. `recoverySim` is the function containing the closed-loop simulation model and is the primary function within the package. The model structure focuses on aggregates of salmon conservation units (CUs), the focal unit for assessing Canadian Pacific salmon status [@DFO2005]. Generally all CUs included within a single analysis should be managed simultaneously as a management unit (MU); however, the model can be adapted to include multiple MUs with distinct harvest rates. Although initial case studies focused on Fraser River sockeye salmon and Area 3 chum salmon, `samSim` is intended to be applicable to any Pacific salmon species as long as two requirements are met. First, CU-specific stock-recruit parameters and age-at-maturity values must be available to parameterize the operating model. Ideally these would be derived from observed, CU-specific time series of age-structured spawner and recruit abundance, however they can also be generated using alternative techniques (e.g. habitat-based estimates; expert opinion). Second, harvest of immature fish must be minimal because offshore fisheries are not accounted for in the model.

`recoverySim` uses observed time series of spawner abundance to prime the simulation so that each CU's initial status reflects the most recent assessment. Those abundances, along with externally estimated stock-recruit parameters, are used as inputs to a Ricker model (Larkin models can also be used for cyclic CUs), which generates a cohort of _recruits_ (i.e. the total number of adult offspring produced by a given brood year of spawners). This process is stochastic, generating representative interannual variation in recruitment deviations, and can incorporate covariance among CUs, as well as temporal autocorrelation. Age-at-maturity varies among simulated recruits based on input parameters, with stochastic variability introduced via multivariate logistic error. This process creates cohorts of _returns_, the total number of adult offspring returning to spawn in a given year, which consist of mature fish of various ages and brood years. 

Simulated returns are next subject to harvest in American fisheries, if relevant, which typically occurs during return migrations before Canadian CUs enter nearshore areas. American catches are always generated using a fixed exploitation rate passed as an input value. Canadian mixed-CU fishery harvest occurs next and catch rates are determined by one of three harvest control rules (HCRs): fixed exploitation rate, generic abundance-based, or total allowable mortality (TAM). The generic abundance-based HCR increases exploitation rates from a minimum value when return abundance exceeds user-specific reference points. The TAM rule is similar to the generic abundance-based HCR, but has additional modifications currently implemented in Fraser River sockeye salmon management [@pestal2011]. In both the American and Canadian mixed-CU fisheries, target catches (generated using the HCR) are converted to realized catches by incorporating stochastic outcome uncertainty [@Holt2006]. CU-specific realized catch is calculated as a function of relative abundance. Once catch has been removed the remaining returns become spawners, creating the subsequent generation of recruits. 

```{r fig2, fig.cap="Changes in aggregate conservation- and catch-based performance metrics (escapement - purple; catch - blue; proportion of CUs above benchmark - green; extinction risk - red) as fixed exploitation rates increase. Dark lines represent median values and polygons the 90th percentile interval across Monte Carlo trials."}
knitr::include_graphics("knitr-figs-pdf/MSEschematic.png")
```

```{r testtab}
d <- structure(list(
  Year = c("2018", "2019", "2020"), 
  `Value 1` = c(1.12, 2.32, 3.67), 
  `Value 2` = c(31.9, 2.8, 112.2)), 
  row.names = c(NA, -3L), class = "data.frame")

csasdown::csas_table(d,
  align = c("c", "r", "r"),
  caption = "Test table with a caption will be numbered automatically.")
```

See Table \@ref(tab:testtab) for the example table.

See Figure \@ref(fig:fig1) for the example figure.

\clearpage
